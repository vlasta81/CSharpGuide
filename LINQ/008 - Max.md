
### **`Max`**  

Metoda `Max` slou≈æ√≠ k **nalezen√≠ maxim√°ln√≠ hodnoty** v kolekci. Je souƒç√°st√≠ standardn√≠ch agregac√≠ LINQ a podporuje pr√°ci s ƒç√≠seln√Ωmi typy, ≈ôetƒõzci, objekty i vlastn√≠mi kompar√°tory.

---

#### **Z√°kladn√≠ charakteristika**  

- **√öƒçel**: Naj√≠t nejvƒõt≈°√≠ prvek v kolekci nebo maxim√°ln√≠ hodnotu vybran√© vlastnosti.  
- **Podporovan√© typy**:  
  - ƒå√≠seln√© typy (`int`, `double`, `decimal` apod.).  
  - ≈òetƒõzce (porovn√°v√° lexikograficky).  
  - Objekty s implementovan√Ωm `IComparable` nebo pomoc√≠ selektoru.  
- **N√°vratov√Ω typ**:  
  - Stejn√Ω jako typ prvk≈Ø (nebo `T?` pro nullable typy).  
  - Pokud je kolekce pr√°zdn√°:  
    - Pro **non-nullable typy** vyvol√° `InvalidOperationException`.  
    - Pro **nullable typy** vr√°t√≠ `null`.  

---

### **Syntaxe**  

```csharp
// Pro kolekci ƒç√≠sel:
int maxNumber = numbers.Max();

// Pro objekty s v√Ωbƒõrem vlastnosti:
decimal maxPrice = products.Max(p => p.Price);

// Pro ≈ôetƒõzce:
string maxString = strings.Max(); // Lexikografick√© porovn√°n√≠
```

---

### **Kl√≠ƒçov√© vlastnosti**  

1. **Integrace s podm√≠nkami**:  
   ```csharp
   // Max cena produkt≈Ø skladem
   decimal maxInStock = products
       .Where(p => p.IsInStock)
       .Max(p => p.Price);
   ```

2. **Podpora pro nullable typy**:  
   ```csharp
   List<int?> values = new List<int?> { 10, null, 20 };
   int? max = values.Max(); // 20
   ```

3. **Optimalizace v LINQ to Entities**:  
   - P≈ôi pou≈æit√≠ s Entity Framework se p≈ôev√°d√≠ na SQL `MAX()`.  
   ```csharp
   var maxAge = dbContext.People.Max(p => p.Age); // Generuje SQL: SELECT MAX(Age) FROM People
   ```

---

### **P≈ô√≠klady pou≈æit√≠**  

#### **1. Z√°kladn√≠ pou≈æit√≠ s ƒç√≠sly**  

```csharp
List<int> numbers = new List<int> { 5, 3, 8, 1 };
int max = numbers.Max(); // 8
```

#### **2. Max hodnota u objekt≈Ø**  

```csharp
class Person { public int Age { get; set; } }
List<Person> people = new List<Person> { new Person { Age = 25 }, new Person { Age = 30 } };
int oldestAge = people.Max(p => p.Age); // 30
```

#### **3. Pr√°ce s ≈ôetƒõzci**  

```csharp
List<string> words = new List<string> { "apple", "banana", "cherry" };
string maxWord = words.Max(); // "cherry" (lexikografick√© porovn√°n√≠)
```

#### **4. Max datum v kolekci**  

```csharp
List<DateTime> dates = new List<DateTime> { new DateTime(2023, 1, 1), new DateTime(2024, 1, 1) };
DateTime latestDate = dates.Max(); // 2024-01-01
```

---

### **ƒåast√© chyby a upozornƒõn√≠**  

1. **Pr√°zdn√° kolekce u non-nullable typ≈Ø**:  
   ```csharp
   List<int> empty = new List<int>();
   int max = empty.Max(); // Vyvol√° InvalidOperationException
   ```

2. **Neo≈°et≈ôen√© `null` hodnoty**:  
   ```csharp
   List<Person> people = new List<Person> { null, new Person { Age = 30 } };
   int maxAge = people.Max(p => p.Age); // Vyvol√° NullReferenceException
   ```

3. **Z√°mƒõna s `OrderByDescending().FirstOrDefault()`**:  
   ```csharp
   // M√©nƒõ efektivn√≠ ne≈æ Max():
   var max = numbers.OrderByDescending(n => n).FirstOrDefault();
   ```

---

### **Tipy pro efektivn√≠ pou≈æit√≠**  

- **Kontrola pr√°zdn√© kolekce**:  
  ```csharp
  if (kolekce.Any()) 
  {
      var max = kolekce.Max();
  }
  ```
- **V√Ωchoz√≠ hodnota pro pr√°zdnou kolekci**:  
  ```csharp
  int max = numbers.DefaultIfEmpty(0).Max(); // Vr√°t√≠ 0, pokud je kolekce pr√°zdn√°
  ```
- **Kombinace s `Select` pro komplexn√≠ objekty**:  
  ```csharp
  var maxProduct = products
      .Select(p => p.Price)
      .Max();
  ```

---

### **Srovn√°n√≠ s podobn√Ωmi metodami** 

| Metoda                 | Popis                                      | P≈ô√≠klad                      |
|------------------------|--------------------------------------------|-----------------------------|
| **Max**                | Vr√°t√≠ maxim√°ln√≠ hodnotu.                   | `numbers.Max()`             |
| **Min**                | Vr√°t√≠ minim√°ln√≠ hodnotu.                   | `numbers.Min()`             |
| **MaxBy** (C# 10+)     | Vr√°t√≠ objekt s maxim√°ln√≠ hodnotou vlastnosti. | `people.MaxBy(p => p.Age)` |

---

### **Shrnut√≠** 

- `Max` je **efektivn√≠ n√°stroj pro nalezen√≠ maxima** v kolekci.  
- Funguje s ƒç√≠sly, ≈ôetƒõzci, daty a objekty (pomoc√≠ selektoru).  
- Pro pr√°zdn√© kolekce vy≈æaduje o≈°et≈ôen√≠ (`try-catch` nebo `DefaultIfEmpty`).  
- V LINQ to Entities generuje optimalizovan√© SQL dotazy.  

üìñ **Zdroj**: [Microsoft Docs ‚Äì Max](https://learn.microsoft.com/cs-cz/dotnet/api/system.linq.enumerable.max)
