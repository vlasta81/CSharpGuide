
### **`Sum`**  

Metoda `Sum` slou≈æ√≠ k **v√Ωpoƒçtu souƒçtu ƒç√≠seln√Ωch hodnot** v kolekci nebo u vybran√© vlastnosti objekt≈Ø. Je jednou ze z√°kladn√≠ch agregac√≠ LINQ a podporuje r≈Øzn√© numerick√© typy vƒçetnƒõ nullable verz√≠.

---

#### **Z√°kladn√≠ charakteristika**  

- **√öƒçel**: Seƒç√≠st hodnoty v kolekci nebo hodnoty z√≠skan√© z vlastnosti objekt≈Ø.  
- **Podporovan√© typy**: `int`, `long`, `float`, `double`, `decimal` a jejich nullable varianty.  
- **N√°vratov√Ω typ**:  
  - Pro non-nullable typy: stejn√Ω jako typ prvk≈Ø (nap≈ô. `int` pro `List<int>`).  
  - Pro nullable typy: `T?` (nap≈ô. `decimal?` pro `List<decimal?>`).  
- **Pr√°zdn√° kolekce**:  
  - Pro **non-nullable typy**: Vyvol√° `InvalidOperationException`.  
  - Pro **nullable typy**: Vr√°t√≠ `null`.  

---

### **Syntaxe**  

```csharp
// Souƒçet prvk≈Ø kolekce:
int sum = kolekce.Sum();

// Souƒçet vybran√© vlastnosti objekt≈Ø:
decimal total = kolekce.Sum(x => x.Vlastnost);
```

---

### **Kl√≠ƒçov√© vlastnosti**  

1. **Ignorov√°n√≠ `null` hodnot u nullable typ≈Ø**:  
   ```csharp
   List<int?> values = new List<int?> { 10, null, 20, null };
   int? sum = values.Sum(); // 30
   ```

2. **Integrace s dal≈°√≠mi oper√°tory**:  
   ```csharp
   // Souƒçet cen v≈°ech aktivn√≠ch produkt≈Ø:
   decimal totalActive = products
       .Where(p => p.IsActive)
       .Sum(p => p.Price);
   ```

3. **Optimalizace v LINQ to Entities (EF Core)**:  
   - P≈ôev√°d√≠ se na SQL `SUM()`.  
   ```csharp
   var totalSales = dbContext.Orders.Sum(o => o.Amount); // Generuje SQL: SELECT SUM(Amount) FROM Orders
   ```

---

### **P≈ô√≠klady pou≈æit√≠**  

#### **1. Souƒçet ƒç√≠sel v kolekci**  

```csharp
List<int> numbers = new List<int> { 10, 20, 30 };
int sum = numbers.Sum(); // 60
```

#### **2. Souƒçet vlastnosti objekt≈Ø**  

```csharp
class Product { public string Name { get; set; } public decimal Price { get; set; } }
List<Product> products = new List<Product> { /* ... */ };

decimal totalPrice = products.Sum(p => p.Price);
```

#### **3. Pr√°ce s nullable typy**  

```csharp
List<decimal?> amounts = new List<decimal?> { 100.5m, null, 200.0m };
decimal? total = amounts.Sum(); // 300.5m
```

#### **4. O≈°et≈ôen√≠ pr√°zdn√© kolekce**  

```csharp
List<int> empty = new List<int>();
int sum = empty.DefaultIfEmpty(0).Sum(); // 0
```

---

### **ƒåast√© chyby a upozornƒõn√≠**  

1. **Pr√°zdn√° kolekce u non-nullable typ≈Ø**:  
   ```csharp
   List<int> empty = new List<int>();
   int sum = empty.Sum(); // Vyvol√° InvalidOperationException!
   ```

2. **Neoƒçek√°van√© `null` hodnoty v nullable kolekc√≠ch**:  
   ```csharp
   List<int?> values = new List<int?> { null, null };
   int? sum = values.Sum(); // null (pokud jsou v≈°echny prvky null)
   ```

3. **Pou≈æit√≠ na neƒç√≠seln√© typy**:  
   ```csharp
   List<string> texts = new List<string> { "10", "20" };
   // Chyba: nelze pou≈æ√≠t Sum() p≈ô√≠mo na ≈ôetƒõzce!
   int sum = texts.Sum(s => int.Parse(s)); // Spr√°vnƒõ: nejprve p≈ôev√©st na ƒç√≠sla
   ```

---

### **Tipy pro efektivn√≠ pou≈æit√≠**  

- **Kombinujte s `Where` pro filtraci p≈ôed v√Ωpoƒçtem**:  
  ```csharp
  decimal total = orders.Where(o => o.Date.Year == 2023).Sum(o => o.Amount);
  ```
- **V√Ωchoz√≠ hodnota pro pr√°zdn√© kolekce**:  
  ```csharp
  int sum = numbers.DefaultIfEmpty(0).Sum();
  ```
- **Optimalizace u velk√Ωch datov√Ωch sad**:  
  - Pro datab√°zov√© dotazy (EF Core) v≈ædy preferujte `Sum` na stranƒõ serveru.  

---

### **Srovn√°n√≠ s `Aggregate`**  

| Vlastnost               | **`Sum`**                               | **`Aggregate`**                       |
|-------------------------|-----------------------------------------|----------------------------------------|
| **√öƒçel**                | Specializovan√Ω na sƒç√≠t√°n√≠.              | Univerz√°ln√≠ pro libovolnou agregaci.   |
| **Syntaxe**             | Jednodu≈°≈°√≠ pro sƒç√≠t√°n√≠.                 | Vy≈æaduje explicitn√≠ logiku (nap≈ô. `(acc, x) => acc + x`). |
| **Pr√°zdn√° kolekce**     | Vyvol√° v√Ωjimku (non-nullable).          | Vy≈æaduje o≈°et≈ôen√≠ (nap≈ô. seed `0`).    |

---

### **Shrnut√≠**  

- `Sum` je **efektivn√≠ metoda pro v√Ωpoƒçet souƒçtu** ƒç√≠seln√Ωch hodnot.  
- Podporuje **nullable typy** a **vlastnosti objekt≈Ø**.  
- Pro pr√°zdn√© kolekce non-nullable typ≈Ø vy≈æaduje o≈°et≈ôen√≠ (`try-catch` nebo `DefaultIfEmpty`).  
- Vhodn√© pro **datab√°zov√© dotazy** (EF Core) d√≠ky p≈ôevodu na SQL `SUM()`.  

üìñ **Zdroj**: [Microsoft Docs ‚Äì Sum](https://learn.microsoft.com/cs-cz/dotnet/api/system.linq.enumerable.sum)
